<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil del Alumno</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }

    @keyframes slideIn {
      0% {
        transform: perspective(1000px) rotateY(70deg) translateZ(-300px);
        opacity: 0;
      }

      100% {
        transform: perspective(1000px) rotateY(0deg) translateZ(0);
        opacity: 1;
      }
    }

    @keyframes slideOut {
      0% {
        transform: perspective(1000px) rotateY(0deg) translateZ(0);
        opacity: 1;
      }

      100% {
        transform: perspective(1000px) rotateY(70deg) translateZ(-300px);
        opacity: 0;
      }
    }

    .animate-slideIn {
      animation: slideIn 0.6s forwards;
    }

    .animate-slideOut {
      animation: slideOut 0.6s forwards;
    }
  </style>
</head>

<body class="bg-gradient-to-br from-blue-400 to-purple-600 min-h-screen flex items-center justify-center p-4">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Componente Modal para el inicio de sesión del administrador
    const AdminLoginModal = ({ show, onClose, onAdminLoginSuccess, selectedCareer }) => {
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');

      const handleLogin = async () => {
        setError('');
        try {
          const response = await fetch('/admin/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ username, password }),
          });

          const data = await response.json();

          if (response.ok) {
            onAdminLoginSuccess(selectedCareer);
            onClose();
          } else {
            setError(data.error || 'Error en el inicio de sesión del administrador.');
          }
        } catch (error) {
          console.error('Error:', error);
          setError('Error de conexión. Inténtalo de nuevo.');
        }
      };

      if (!show) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white p-6 rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 scale-100 opacity-100">
            <h2 className="text-2xl font-bold text-center text-gray-800 mb-4">Acceso de Administrador</h2>
            {error && <p className="text-red-500 text-center mb-4">{error}</p>}
            <input
              type="text"
              placeholder="Usuario"
              className="w-full p-3 mb-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              value={username}
              onChange={(e) => setUsername(e.target.value)}
            />
            <input
              type="password"
              placeholder="Contraseña"
              className="w-full p-3 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus-ring-blue-500"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
            />
            <button
              onClick={handleLogin}
              className="bg-blue-600 text-white px-4 py-3 rounded-full shadow-lg hover:bg-blue-700 transition-all duration-300 w-full font-semibold"
            >
              Ingresar
            </button>
            <button
              onClick={onClose}
              className="text-sm text-gray-500 hover:underline mt-4 w-full transition-colors duration-300"
            >
              Cancelar
            </button>
          </div>
        </div>
      );
    };

    // Componente Dashboard del Administrador
    const AdminDashboard = ({ show, onClose, studentsData, updateStudentData, selectedCareer, calculateLevel, onRefreshStudents }) => {
      const [editingStudentId, setEditingStudentId] = useState(null);
      const [editFormData, setEditFormData] = useState({
        id: '',
        nombre: '',
        email: '',
        password: '',
        tareas: 0,
        monedas: 0,
        asistencias: 0,
        gamesChallenges: '', // <-- MODIFICACIÓN: Añadido gamesChallenges
        exp: 0,
      });
      const [filter, setFilter] = useState('');

      useEffect(() => {
        if (show) {
          onRefreshStudents(); // Refresh data when dashboard is shown
        }
      }, [show, onRefreshStudents]);


      const handleEditClick = (student) => {
        setEditingStudentId(student.id);
        setEditFormData({
          id: student.id,
          nombre: student.nombre,
          email: student.email,
          password: student.password,
          tareas: student.tareas,
          monedas: student.monedas,
          asistencias: student.asistencias,
          gamesChallenges: student.gamesChallenges, // <-- MODIFICACIÓN: Añadido gamesChallenges
          exp: student.exp,
        });
      };

      const handleSaveClick = async () => {
        try {
          const response = await fetch(`/student/${editFormData.id}`, {
            method: 'PUT',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ ...editFormData, career: selectedCareer }),
          });

          if (response.ok) {
            await onRefreshStudents(); // Refrescar la lista completa de estudiantes
            setEditingStudentId(null); // Salir del modo de edición
          } else {
            console.error('Error al actualizar estudiante:', await response.json());
            alert('Error al actualizar los datos del estudiante.');
          }
        } catch (error) {
          console.error('Error de red al actualizar estudiante:', error);
          alert('Error de conexión al intentar actualizar.');
        }
      };

      const handleCancelClick = () => {
        setEditingStudentId(null);
      };

      const handleChange = (e) => {
        const { name, value } = e.target;
        setEditFormData(prev => ({
          ...prev,
          [name]: name === 'tareas' || name === 'monedas' || name === 'asistencias' || name === 'exp' ? parseInt(value) || 0 : value,
        }));
      };

      const filteredStudents = studentsData.filter(student =>
        student.id.toLowerCase().includes(filter.toLowerCase()) ||
        student.nombre.toLowerCase().includes(filter.toLowerCase()) ||
        student.email.toLowerCase().includes(filter.toLowerCase())
      );

      if (!show) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4 overflow-y-auto">
          <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300 scale-100 opacity-100">
            <h2 className="text-3xl font-bold text-center text-gray-800 mb-6">Panel de Administrador</h2>

            <div className="mb-6">
              <input
                type="text"
                placeholder="Filtrar por ID, Nombre o Email"
                className="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                value={filter}
                onChange={(e) => setFilter(e.target.value)}
              />
            </div>

            <div className="overflow-x-auto">
              <table className="min-w-full bg-white rounded-lg shadow-md">
                <thead className="bg-gray-200">
                  <tr>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">ID</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Nombre</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Email</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Password</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Tareas</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Monedas</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Asistencias</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Games / Challenges</th> {/* <-- MODIFICACIÓN: Nuevo encabezado */}
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">EXP</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Nivel</th>
                    <th className="py-3 px-4 text-left text-sm font-semibold text-gray-600">Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  {filteredStudents.map((student) => (
                    <tr key={student.id} className="border-b last:border-0 hover:bg-gray-50">
                      {editingStudentId === student.id ? (
                        <>
                          <td className="py-3 px-4"><input type="text" name="id" value={editFormData.id} onChange={handleChange} className="w-20 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="text" name="nombre" value={editFormData.nombre} onChange={handleChange} className="w-28 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="text" name="email" value={editFormData.email} onChange={handleChange} className="w-32 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="text" name="password" value={editFormData.password} onChange={handleChange} className="w-28 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="number" name="tareas" value={editFormData.tareas} onChange={handleChange} className="w-20 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="number" name="monedas" value={editFormData.monedas} onChange={handleChange} className="w-20 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="number" name="asistencias" value={editFormData.asistencias} onChange={handleChange} className="w-20 p-1 border rounded" /></td>
                          <td className="py-3 px-4"><input type="text" name="gamesChallenges" value={editFormData.gamesChallenges} onChange={handleChange} className="w-28 p-1 border rounded" /></td> {/* <-- MODIFICACIÓN: Nuevo input para edición */}
                          <td className="py-3 px-4"><input type="number" name="exp" value={editFormData.exp} onChange={handleChange} className="w-20 p-1 border rounded" /></td>
                          <td className="py-3 px-4 text-center">{calculateLevel(editFormData.exp)}</td>
                          <td className="py-3 px-4">
                            <div className="flex space-x-2">
                              <button onClick={handleSaveClick} className="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors duration-200">Guardar</button>
                              <button onClick={handleCancelClick} className="bg-gray-400 text-white px-3 py-1 rounded text-sm hover:bg-gray-500 transition-colors duration-200">Cancelar</button>
                            </div>
                          </td>
                        </>
                      ) : (
                        <>
                          <td className="py-3 px-4">{student.id}</td>
                          <td className="py-3 px-4">{student.nombre}</td>
                          <td className="py-3 px-4">{student.email}</td>
                          <td className="py-3 px-4">{student.password}</td>
                          <td className="py-3 px-4">{student.tareas}</td>
                          <td className="py-3 px-4">{student.monedas}</td>
                          <td className="py-3 px-4">{student.asistencias}</td>
                          <td className="py-3 px-4">{student.gamesChallenges}</td> {/* <-- MODIFICACIÓN: Muestra el valor */}
                          <td className="py-3 px-4">{student.exp}</td>
                          <td className="py-3 px-4">{student.level}</td>
                          <td className="py-3 px-4">
                            <button
                              onClick={() => handleEditClick(student)}
                              className="bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors duration-200"
                            >
                              Editar
                            </button>
                          </td>
                        </>
                      )}
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>

            <div className="mt-6 flex justify-center">
              <button
                onClick={onClose}
                className="bg-red-500 text-white px-6 py-3 rounded-full shadow-lg hover:bg-red-600 transition-all duration-300 font-semibold"
              >
                Cerrar Sesión
              </button>
            </div>
          </div>
        </div>
      );
    };

    // Componente de Perfil del Alumno
    const StudentProfile = ({ student, onLogout, calculateLevel, selectedCareer, showAdminLogin }) => {
      if (!student) return null;

      const level = calculateLevel(student.exp);

      return (
        <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-500 animate-slideIn">
          <h2 className="text-3xl font-bold text-center text-gray-800 mb-6">¡Hola, {student.nombre}!</h2>

          <div className="space-y-4 text-lg text-gray-700">
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">ID:</span>
              <span>{student.id}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Carrera:</span>
              <span>{selectedCareer === 'Com' ? 'Comunicación' : 'Programación'}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Email:</span>
              <span>{student.email}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Tareas Completadas:</span>
              <span>{student.tareas}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Monedas Obtenidas:</span>
              <span>{student.monedas}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Asistencias:</span>
              <span>{student.asistencias}</span>
            </div>

            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Games / Challenges:</span>
              <span>{student.gamesChallenges}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">EXP:</span>
              <span>{student.exp}</span>
            </div>
            <div className="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm">
              <span className="font-semibold">Nivel:</span>
              <span className="font-bold text-blue-600">{level}</span>
            </div>
          </div>

          <div className="mt-8 flex flex-col space-y-4">
            <button
              onClick={onLogout}
              className="bg-red-500 text-white px-6 py-3 rounded-full shadow-lg hover:bg-red-600 transition-all duration-300 w-full font-semibold"
            >
              Cerrar Sesión
            </button>
            <button
              onClick={showAdminLogin}
              className="bg-gray-700 text-white px-6 py-3 rounded-full shadow-lg hover:bg-gray-800 transition-all duration-300 w-full font-semibold"
            >
              Acceso Administrador
            </button>
          </div>
        </div>
      );
    };

    // Componente de Inicio de Sesión
    const Login = ({ onLoginSuccess, onShowReset, onCareerSelect }) => {
      const [id, setId] = useState('');
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');
      const [selectedCareer, setSelectedCareer] = useState('');

      const handleLogin = async () => {
        setError('');
        if (!selectedCareer) {
          setError('Por favor, selecciona una carrera.');
          return;
        }

        try {
          const response = await fetch('/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ id, password, career: selectedCareer }),
          });

          const data = await response.json();

          if (response.ok) {
            onLoginSuccess(data.student, selectedCareer);
          } else {
            setError(data.error || 'Error en el inicio de sesión.');
          }
        } catch (error) {
          console.error('Error:', error);
          setError('Error de conexión. Inténtalo de nuevo.');
        }
      };

      return (
        <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-sm transform transition-all duration-500 animate-slideIn">
          <h2 className="text-3xl font-bold text-center text-gray-800 mb-6">Bienvenido</h2>
          {error && <p className="text-red-500 text-center mb-4">{error}</p>}

          <div className="mb-4">
            <label htmlFor="career" className="block text-gray-700 text-sm font-bold mb-2">
              Selecciona tu carrera:
            </label>
            <select
              id="career"
              className="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"
              value={selectedCareer}
              onChange={(e) => {
                setSelectedCareer(e.target.value);
                onCareerSelect(e.target.value);
              }}
            >
              <option value="">-- Selecciona --</option>
              <option value="Programacion">Programación</option>
              <option value="Com">Comunicación</option>
            </select>
          </div>

          <input
            type="text"
            placeholder="ID de Alumno"
            className="w-full p-3 mb-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"
            value={id}
            onChange={(e) => setId(e.target.value)}
          />
          <input
            type="password"
            placeholder="Contraseña"
            className="w-full p-3 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
          />
          <button
            onClick={handleLogin}
            className="bg-orange-500 text-white px-4 py-3 rounded-full shadow-lg hover:bg-orange-600 transition-all duration-300 w-full font-semibold"
          >
            Iniciar Sesión
          </button>
          <button
            onClick={onShowReset}
            className="text-sm text-gray-500 hover:underline mt-4 w-full transition-colors duration-300"
          >
            ¿Olvidaste tu contraseña?
          </button>
        </div>
      );
    };

    // Componente principal de la aplicación
    const App = () => {
      const [student, setStudent] = useState(null);
      const [showReset, setShowReset] = useState(false);
      const [resetEmail, setResetEmail] = useState('');
      const [resetCode, setResetCode] = useState('');
      const [resetId, setResetId] = useState('');
      const [resetPass, setResetPass] = useState('');
      const [showCodeField, setShowCodeField] = useState(false);
      const [resetMessage, setResetMessage] = useState('');
      const [resetError, setResetError] = useState('');
      const [selectedCareer, setSelectedCareer] = useState('');
      const [showAdminLoginModal, setShowAdminLoginModal] = useState(false);
      const [showAdminDashboard, setShowAdminDashboard] = useState(false);
      const [adminStudentsData, setAdminStudentsData] = useState([]);


      const calculateLevel = (exp) => {
        if (exp >= 1000) return 5;
        if (exp >= 500) return 4;
        if (exp >= 200) return 3;
        if (exp >= 50) return 2;
        return 1;
      };

      const handleLoginSuccess = (studentData, career) => {
        setStudent(studentData);
        setSelectedCareer(career);
      };

      const handleLogout = () => {
        setStudent(null);
        setShowAdminDashboard(false);
        setAdminStudentsData([]);
        setSelectedCareer('');
      };

      const handleShowReset = () => {
        setShowReset(true);
        setResetMessage('');
        setResetError('');
      };

      const handleSendResetCode = async () => {
        setResetMessage('');
        setResetError('');
        if (!resetEmail) {
          setResetError('Por favor, ingresa tu correo electrónico.');
          return;
        }
        if (!selectedCareer) {
          setResetError('Por favor, selecciona una carrera.');
          return;
        }

        try {
          const response = await fetch('/send-reset-code', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: resetEmail, career: selectedCareer }),
          });
          const data = await response.json();
          if (response.ok) {
            setResetMessage(data.message);
            setResetId(data.resetId); // Guardar el ID del estudiante para la verificación
            setShowCodeField(true);
          } else {
            setResetError(data.error);
          }
        } catch (error) {
          console.error('Error:', error);
          setResetError('Error de conexión.');
        }
      };

      const handleVerifyResetCode = async () => {
        setResetMessage('');
        setResetError('');
        if (!resetCode) {
          setResetError('Por favor, ingresa el código.');
          return;
        }

        try {
          const response = await fetch('/verify-reset-code', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ resetId, resetCode, career: selectedCareer }),
          });
          const data = await response.json();
          if (response.ok) {
            setResetMessage(data.message);
            // Si el código es correcto, el usuario ahora puede establecer una nueva contraseña
            // setShowCodeField(false); // Mantener el campo de código visible o cambiar a un nuevo campo de contraseña
          } else {
            setResetError(data.error);
          }
        } catch (error) {
          console.error('Error:', error);
          setResetError('Error de conexión.');
        }
      };

      const handleUpdatePassword = async () => {
        setResetMessage('');
        setResetError('');
        if (!resetPass) {
          setResetError('Por favor, ingresa tu nueva contraseña.');
          return;
        }

        try {
          const response = await fetch('/update-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ resetId, newPassword: resetPass, career: selectedCareer }),
          });
          const data = await response.json();
          if (response.ok) {
            setResetMessage(data.message + " Ahora puedes iniciar sesión con tu nueva contraseña.");
            setTimeout(() => {
              setShowReset(false);
              setShowCodeField(false);
              setResetId('');
              setResetCode('');
              setResetPass('');
              setResetEmail('');
              setResetMessage('');
            }, 3000);
          } else {
            setResetError(data.error);
          }
        } catch (error) {
          console.error('Error:', error);
          setResetError('Error de conexión.');
        }
      };

      const handleAdminLoginSuccess = async (career) => {
        setSelectedCareer(career);
        await fetchAdminStudentsData(career);
        setShowAdminDashboard(true);
      };

      const fetchAdminStudentsData = async (career = selectedCareer) => {
        if (!career) return;
        try {
          const response = await fetch(`/admin/students?career=${career}`);
          if (response.ok) {
            const data = await response.json();
            setAdminStudentsData(data);
          } else {
            console.error('Error fetching admin students data:', await response.json());
          }
        } catch (error) {
          console.error('Network error fetching admin students data:', error);
        }
      };

      const updateStudentDataInAdminDashboard = (updatedStudent) => {
        setAdminStudentsData(prevData =>
          prevData.map(student =>
            student.id === updatedStudent.id ? updatedStudent : student
          )
        );
      };


      return (
        <>
          {student ? (
            <StudentProfile
              student={student}
              onLogout={handleLogout}
              calculateLevel={calculateLevel}
              selectedCareer={selectedCareer}
              showAdminLogin={() => setShowAdminLoginModal(true)}
            />
          ) : (
            <Login
              onLoginSuccess={handleLoginSuccess}
              onShowReset={handleShowReset}
              onCareerSelect={setSelectedCareer}
            />
          )}

          {showReset && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
              <div className="bg-white p-6 rounded-lg shadow-xl w-full max-w-sm transform transition-all duration-300 scale-100 opacity-100">
                <h2 className="text-2xl font-bold text-center text-gray-800 mb-4">Recuperar Contraseña</h2>
                {resetMessage && <p className="text-green-600 text-center mb-4">{resetMessage}</p>}
                {resetError && <p className="text-red-500 text-center mb-4">{resetError}</p>}

                {!showCodeField ? (
                  <>
                    <p className="text-gray-600 text-center mb-4">Ingresa tu correo electrónico asociado a tu cuenta.</p>
                    <input
                      type="email"
                      placeholder="Correo electrónico"
                      className="w-full p-3 mb-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"
                      value={resetEmail}
                      onChange={(e) => setResetEmail(e.target.value)}
                    />
                    <button
                      className="bg-orange-500 text-white px-4 py-3 rounded-full shadow-lg hover:bg-orange-600 transition-all duration-300 w-full font-semibold"
                      onClick={handleSendResetCode}
                    >
                      Enviar código de recuperación
                    </button>
                  </>
                ) : (
                  <>
                    <p className="text-gray-600 text-center mb-4">Se ha enviado un código a tu correo. Ingresa el código y tu nueva contraseña.</p>
                    <input
                      type="text"
                      placeholder="Código de recuperación"
                      className="w-full p-3 mb-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"
                      value={resetCode}
                      onChange={(e) => setResetCode(e.target.value)}
                    />
                    <button
                      className="bg-blue-500 text-white px-4 py-3 rounded-full shadow-lg hover:bg-blue-600 transition-all duration-300 w-full font-semibold mb-3"
                      onClick={handleVerifyResetCode}
                    >
                      Verificar Código
                    </button>
                    <input
                      type="password"
                      placeholder="Nueva contraseña"
                      className="w-full p-3 mb-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"
                      value={resetPass}
                      onChange={(e) => setResetPass(e.target.value)}
                    />
                    <button className="bg-orange-500 text-white px-4 py-3 rounded-full shadow-lg hover:bg-orange-600 transition-all duration-300 w-full mt-2 font-semibold" onClick={handleUpdatePassword}>Actualizar contraseña</button>
                  </>
                )}

                <button className="text-sm text-gray-500 hover:underline mt-2 transition-colors duration-300" onClick={() => {
                  setShowReset(false);
                  setShowCodeField(false);
                  setResetId('');
                  setResetCode('');
                  setResetPass('');
                }}>Cancelar</button>
              </div>
            </div>
          )}

          <AdminLoginModal
            show={showAdminLoginModal}
            onClose={() => setShowAdminLoginModal(false)}
            onAdminLoginSuccess={handleAdminLoginSuccess}
            selectedCareer={selectedCareer}
          />

          <AdminDashboard
            show={showAdminDashboard}
            onClose={handleLogout}
            studentsData={adminStudentsData}
            updateStudentData={updateStudentDataInAdminDashboard}
            selectedCareer={selectedCareer}
            calculateLevel={calculateLevel}
            onRefreshStudents={fetchAdminStudentsData}
          />
        </>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>

</html>